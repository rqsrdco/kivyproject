#: import ew kivy.uix.effectwidget
#: import Window kivy.core.window.Window
#: import FadeTransition kivy.uix.screenmanager.FadeTransition

<LeftPanel>
    size_hint_x: None
    width: dp(68)

<TitleButtons>
    canvas:
        Color:
            rgba: 0,0,0,0
            group: 'a'

        Rectangle:
            size: self.size
            pos: self.pos

<CointainerHeaders>
    canvas:
        Color:
            rgba: 0, 52/255, 102/255, 1
        Rectangle:
            size: dp(5), dp(0)
            pos: 0, Window.size[1]
            group: 'rec'
    size_hint: 1, None
    size: 230, 52
    orientation: 'vertical'
    BoxLayout:
        padding: dp(16),0,dp(16),0
        spacing: dp(8)
        MDIconButton:
            icon: root.icon
            font_name: 'assets/fonts/materialdesignicons-webfont.ttf'
            size_hint: None, None
            size: dp(48), dp(48)
            font_size: '32sp'
            color: root.color
            pos_hint: {'center_x':.5, 'center_y':.5}

        ScreenManager:
            id: sm_main
            Screen:
                name: 'one'

            Screen:
                name: 'two'
                BoxLayout:
                    padding: dp(0),0,dp(6),0
                    spacing: dp(8)
                    
                    MDLabel:
                        text: root.text
                        color: root.color
                        halign: 'left'
                        size_hint_x: None
                        width: self.parent.width - dp(46)
                        valign: 'center'
                        
                    MDIconButton:
                        icon: root.icon1
                        font_size: '32sp'
                        color: root.color
                        size: dp(32), dp(32)
                        font_name: 'assets/fonts/materialdesignicons-webfont.ttf'
                        size_hint: None, None
                        pos_hint: {'center_x':.5, 'center_y':.5}

<AdminScreen>
    curr_date: curr_date
    sm_content: sm_content
    canvas.before:
        Color:
            rgba: app.theme_cls.divider_color
        Rectangle:
            size: self.size
            pos: self.pos

    MDBoxLayout:
        LeftPanel:
            orientation:'vertical'
            on_state: root.change_state_toolbar(self.state)
            canvas:
                Color:
                    rgba: app.theme_cls.primary_color
                Rectangle:
                    size:self.size
                    pos: self.pos
                Color:
                    rgba: 0,0,0,.3 if root.line_nav==True else 1,1,1,0
                Line:
                    rectangle: self.x,self.y, self.width,self.height
            id: hvrt
            BoxLayout:
                id: headers
                elevation: 18
                size_hint:1,None
                size: 1,140
                FloatLayout:
                    Widget:
                        canvas:
                            Color:
                                rgba: 1,1,1,1
                            Rectangle:
                                source: 'assets/images/logoclose.png'
                                size: self.size
                                pos: self.pos
                        id: prof_pic
                        size_hint: None,None
                        size: 68 if hvrt.state== 'normal' else 120, 68 if hvrt.state == 'normal' else 120
                        x: self.parent.x+self.parent.width/2-self.width/2
                        y: self.parent.y+self.parent.height/2-self.height/2
            ScrollView:
                bar_width: 0
                do_scroll_x: False
                do_scroll_y: True
                MDBoxLayout:
                    id: hvrt_boxl
                    size_hint_y: None
                    height: self.minimum_height
                    orientation: 'vertical'
                    padding: 0,dp(8),0,dp(8)

                    CointainerHeaders:
                        id: contH1
                        icon: 'view-dashboard'
                        group:'a'
                        text: 'Home'
                        pos_hint: {'center_x': .5, 'center_y': .5}
                        TitleButtons:
                            size_hint: 1, None
                            height: 50
                            text: "Quick View"
                            on_press: self.state='down'
                            on_press:sm_content.current='quickview'
                            on_press:sm_title.current='quickview'
                        TitleButtons:
                            size_hint: 1, None
                            height: 52
                            text: "Report"
                            on_press: self.state='down'
                            on_press:sm_content.current='report'
                            on_press:sm_title.current='report'
                    CointainerHeaders:
                        id: contH2
                        icon: 'monitor-dashboard'
                        group:'a'
                        text: 'Monitor Taks'
                        pos_hint: {'center_x': .5, 'center_y': .5}
                        TitleButtons:
                            size_hint: 1, None
                            height: 52
                            text: "Bills"
                            on_press: self.state='down'
                            on_press:sm_content.current='bills'
                            on_press:sm_title.current='bills'
                        TitleButtons:
                            size_hint: 1, None
                            height: 52
                            text: "Inventory Management"
                            on_press: self.state='down'
                            on_press:sm_content.current='inventory'
                            on_press:sm_title.current='inventory'
                        TitleButtons:
                            size_hint: 1, None
                            height: 52
                            text: "Staff Management"
                            on_press: self.state='down'
                            on_press:sm_content.current='staff'
                            on_press:sm_title.current='staff'
            MDIconButton:
                on_release: app.root.set_current("authority", side="left")
                icon: "location-exit"
                pos_hint: {'center_x': .5, 'center_y': .5}
        MDBoxLayout:
            orientation: 'vertical'
            size_hint: 1, 1
            MDBoxLayout:
                id: box_title
                size_hint:1,None
                size:1,50
                canvas:
                    Color:
                        rgba: app.theme_cls.primary_color
                    Rectangle:
                        size: self.size
                        pos: self.pos
                ScreenManager:
                    id: sm_title
                    transition: FadeTransition()
                    Screen:
                        name:'quickview'
                        TitleLabel:
                            text:'Quick View'
                    Screen:
                        name:'report'
                        TitleLabel:
                            text:'Reports'
                    Screen:
                        name:'bills'
                        TitleLabel:
                            text:'Bills Taks'
                    Screen:
                        name: 'inventory'
                        TitleLabel:
                            text:'Inventory Taks'
                    Screen:
                        name: 'staff'
                        TitleLabel:
                            text:'Staff Taks'
            MDBoxLayout:
                id: box_notify
                size_hint:1,None
                size: 1,0
            MDBoxLayout:
                ScreenManager:
                    id: sm_content
                    transition: FadeTransition()
                    staff: staff
                    Screen:
                        name: 'quickview'
                        canvas.before:
                            Color:
                                rgba: app.theme_cls.divider_color
                            Rectangle:
                                size: self.size
                                pos: self.pos
                        EffectWidget:
                            effects: [ew.VerticalBlurEffect(size=10),ew.HorizontalBlurEffect(size=10)]
                            FitImage:
                                source: "assets/images/musicbg.jpg"
                        MDBoxLayout:
                            orientation: 'vertical'
                            padding: ['10dp', '10dp', '10dp', '10dp']
                            MDLabel:
                                id: curr_date
                                text: ""
                                pos_hint: {'center_x': .5, 'center_y': .5}
                                font_style: "Button"
                            SongCover:
                                canvas.before:
                                    Color:
                                        rgba: [1,1,1,0]
                                    RoundedRectangle:
                                        size: self.size
                                        pos: self.pos
                                        radius: [250,]
                                id: sc
                                size: (250, 250)
                                size_hint: None, None
                                pos_hint: {'center_x': .5,}
                                RotatingImage:
                                    angle: sc.angle
                                    radius: [250,]
                                    source: "assets/images/songcover.jpg"
                            Widget:
                                size_hint: None, None
                                height: '25dp'
                            Label:
                                text: "Song Name"
                                bold: True
                                font_size: '25sp'
                                size_hint_y: None
                                height: self.texture_size[1]
                            Label:
                                text: "Artist Name"
                                size_hint_y: None
                                height: self.texture_size[1]
                            
                            MDBoxLayout:
                                orientation: 'vertical'
                                Slider:
                                    id: progress
                                    color: [.7,0,0,1]
                                    min: 0
                                    max: 100
                                    value: 0
                                    background_width: '20dp'
                                    cursor_image: ''
                                    cursor_size: ('10dp', '10dp')
                                    value_track_color: [1,1,1,0]
                                    value_track: True
                                MDBoxLayout:
                                    id: play_option
                                    MyIcon:
                                        icon: 'restart'
                                    MyIcon:
                                        icon: 'skip-previous-outline'
                                    MyIcon:
                                        icon: 'skip-backward-outline'
                                    MyIcon:
                                        icon: 'play-outline'
                                        on_press: sc.play(progress)
                                    MyIcon:
                                        icon: 'skip-forward'
                                    MyIcon:
                                        icon: 'skip-next-outline'
                                    MyIcon:
                                        icon: 'format-list-bulleted'
                    Screen:
                        name: 'report'
                    Screen:
                        name: "bills"
                        MyTable:
                            id: mytable
                    Screen:
                        name: 'inventory'
                    Screen:
                        name: 'staff'
                        id: staff
                        MDBoxLayout:
                            orientation: 'horizontal'
                            #adaptive_size: True
                            spacing: dp(5)
                            MDBoxLayout:
                                size_hint_x: None
                                width: dp(365)
                                orientation: 'vertical'
                                ScrollView:
                                    bar_width: 0
                                    size: self.size
                                    do_scroll_x: False
                                    do_scroll_y: True
                                    GridLayout:
                                        id: staff_list
                                        cols: 1
                                        row_default_height: 180
                                        row_force_default: True
                                        effect_cls: "ScrollEffect"
                                        size_hint: (1, None)
                                        height: self.minimum_height
                                        spacing: dp(12)
                                        padding: dp(12)
                            MDBoxLayout:
                                id: staff_infos
                                orientation: 'vertical'
                                ScrollView:
                                    bar_width: 0
                                    effect_cls: "ScrollEffect"
                                    pos_hint: {'center_x': .5, 'center_y': .5}
                                    size_hint: .68, 1
                                    do_scroll_x: False
                                    do_scroll_y: True

                                    GridLayout:
                                        id: container_infos
                                        cols: 1
                                        row_default_height: 39
                                        spacing: dp(12)
                                        padding: dp(12),dp(39),dp(12),dp(39)
                                        size_hint_y:None
                                        height: self.minimum_height
                                        MDTextField:
                                            id: email
                                            icon_right: "email-variant"
                                            hint_text: "Email"
                                            mode: "fill"
                                            #required: True
                                            multiline: False
                                            helper_text_mode: "on_error"
                                            helper_text: "Enter text"
                                            focus: True
                                            on_text_validate: root.check_staff_fields()
                                            fill_color: app.theme_cls.divider_color
                                            current_hint_text_color: app.theme_cls.text_color
                                            line_color_normal:  app.theme_cls.ripple_color
                                            line_color_focus: app.theme_cls.primary_color
                                            icon_right_color: app.theme_cls.primary_color
                                            text_color: app.theme_cls.primary_color
                                            error_color: app.theme_cls.error_color
                                            radius: [12,12,12,12]
                                        MDTextField:
                                            id: pwd
                                            icon_right: "key"
                                            hint_text: "Password"
                                            mode: "fill"
                                            #required: True
                                            multiline: False
                                            helper_text_mode: "on_error"
                                            helper_text: "Enter text"
                                            on_text_validate: root.check_staff_fields()
                                            fill_color: app.theme_cls.divider_color
                                            current_hint_text_color: app.theme_cls.text_color
                                            line_color_normal:  app.theme_cls.ripple_color
                                            line_color_focus: app.theme_cls.primary_color
                                            icon_right_color: app.theme_cls.primary_color
                                            text_color: app.theme_cls.primary_color
                                            error_color: app.theme_cls.error_color
                                            radius: [12,12,12,12]
                                        MDTextField:
                                            id: first_name
                                            icon_right: "account-tie"
                                            hint_text: "First Name"
                                            mode: "fill"
                                            #required: True
                                            multiline: False
                                            helper_text_mode: "on_error"
                                            helper_text: "Enter text"
                                            on_text_validate: root.check_staff_fields()
                                            fill_color: app.theme_cls.divider_color
                                            current_hint_text_color: app.theme_cls.text_color
                                            line_color_normal:  app.theme_cls.ripple_color
                                            line_color_focus: app.theme_cls.primary_color
                                            icon_right_color: app.theme_cls.primary_color
                                            text_color: app.theme_cls.primary_color
                                            error_color: app.theme_cls.error_color
                                            radius: [12,12,12,12]
                                        MDTextField:
                                            id: last_name
                                            icon_right: "account-tie"
                                            hint_text: "Last Name"
                                            mode: "fill"
                                            #required: True
                                            multiline: False
                                            helper_text_mode: "on_error"
                                            helper_text: "Enter text"
                                            on_text_validate: root.check_staff_fields()
                                            fill_color: app.theme_cls.divider_color
                                            current_hint_text_color: app.theme_cls.text_color
                                            line_color_normal:  app.theme_cls.ripple_color
                                            line_color_focus: app.theme_cls.primary_color
                                            icon_right_color: app.theme_cls.primary_color
                                            text_color: app.theme_cls.primary_color
                                            error_color: app.theme_cls.error_color
                                            radius: [12,12,12,12]
                                        MDTextField:
                                            id: phone
                                            icon_right: "phone-in-talk-outline"
                                            hint_text: "Phone number"
                                            mode: "fill"
                                            #required: True
                                            multiline: False
                                            max_text_length: 10
                                            helper_text_mode: "on_error"
                                            helper_text: "Enter text"
                                            on_text_validate: root.check_staff_fields()
                                            fill_color: app.theme_cls.divider_color
                                            current_hint_text_color: app.theme_cls.text_color
                                            line_color_normal:  app.theme_cls.ripple_color
                                            line_color_focus: app.theme_cls.primary_color
                                            icon_right_color: app.theme_cls.primary_color
                                            text_color: app.theme_cls.primary_color
                                            error_color: app.theme_cls.error_color
                                            radius: [12,12,12,12]
                                        MDDropDownItem:
                                            id: drop_gender
                                            pos_hint: {'center_x': .5}
                                            text: 'Gender'
                                            on_release: root.gender_menu.open()
                                        BoxLayout:
                                            spacing: container_infos.width - drop_role.width - add_role.width - dp(24)
                                            orientation: 'horizontal'
                                            MDDropDownItem:
                                                id: drop_role
                                                pos_hint: {'center_y': .5}
                                                text: 'Role'
                                                on_release: root.role_menu.open()
                                            Button:
                                                id: add_role
                                                text: "add New Role"
                                                pos_hint: {'center_y': .5}
                                                size_hint_x: None
                                                width: dp(120)
                                                on_press: root.addrole_callback()
                                        MDLabel:
                                            id: member_seen
                                            adaptive_height: True
                                            font_style: "Body2"
                                            theme_text_color: "Primary"
                                            halign: "center"
                                BoxLayout:
                                    size_hint_y: None
                                    height: dp(52)
                                    padding: dp(12), dp(6),dp(12),dp(6)
                                    spacing: dp(12)
                                    orientation: 'horizontal'
                                    Button:
                                        text: "Save Changes"
                                        pos_hint: {'center_y': .5}
                                        on_press: root.save_edited_staff()
                                    Button:
                                        text: "New Account"
                                        pos_hint: {'center_y': .5}
                                        on_press: root.save_new_staff()# root.save_new_staff()
                                    Button:
                                        text: "Delete Account"
                                        pos_hint: {'center_y': .5}
                                        on_press: root.delete_staff_detail()

<AddRolePopup>
    size_hint: None, None
    size: 234, 157
    title_size: 20
    # title_font: "Verdana"
    auto_dismiss: False
    title_align: 'center'
    title_color: app.theme_cls.text_color
    separator_height: dp(0)
    background_color: app.theme_cls.accent_color
    BoxLayout:
        orientation: "vertical"
        padding: dp(12)
        spacing: dp(39)

        MDTextFieldRound:
            id: text_field
            size_hint_y: None
            hint_text: "add new Role"
            normal_color: app.theme_cls.accent_color
            color_active: app.theme_cls.primary_light
            icon_left: "timeline-help"
            padding:
                self._lbl_icon_left.texture_size[1] + dp(10) if self.icon_left else dp(15)

        BoxLayout:
            size_hint_y: None
            height: dp(52)
            spacing: dp(12)
            orientation: 'horizontal'
            Button:
                text: "Save"
                pos_hint: {'center_y': .5}
                on_release: root.set_newRole()
            Button:
                text: "Cancel"
                pos_hint: {'center_y': .5}
                on_release: root.dismiss()

<IconListItem>
    IconLeftWidget:
        icon: root.icon

<StaffItem>
    orientation: "vertical"
    size_hint: 1, None
    height: dp(180)
    #size: dp(365),dp(230)
    #adaptive_height: True
    #size: root.parent.height,root.parent.height
    focus_behavior: True
    ripple_behavior: True
    #pos_hint: {"center_x": .5, "center_y": .5}
    radius: [12,root.height - box_bottom.height/2,12,12]

    MDBoxLayout:
        id: box_top
        spacing: "12dp"
        adaptive_height: True
        orientation: "horizontal"

        MDBoxLayout:
            id: text_box
            orientation: "vertical"
            adaptive_height: True
            spacing: "10dp"
            padding: "10dp", "10dp", "10dp", "10dp"

            MDLabel:
                text: root._staff.first_name + ' ' + root._staff.last_name
                theme_text_color: "Primary"
                font_style: "Subtitle1"
                bold: True
                adaptive_height: True
                halign: "right"

            MDLabel:
                text: root._staff.email
                theme_text_color: "Primary"
                font_style: "Caption"
                bold: True
                adaptive_height: True
                halign: "right"

            MDLabel:
                text: root._staff.phone_number
                theme_text_color: "Primary"
                font_style: "Button"
                bold: True
                adaptive_height: True
                halign: "right"

            MDLabel:
                text: root._staff.role.role
                adaptive_height: True
                font_style: "Body2"
                theme_text_color: "Primary"
                halign: "center"

        FitImage:
            source: root._staff.avatar_url if root._staff.avatar_url else "assets/images/user/account.png"
            size_hint: None, None
            size:  root.height - box_bottom.height,root.height - box_bottom.height
            pos_hint: {"right": 1,"top": 1}
            radius: root.height - box_bottom.height/2

    MDSeparator:

    MDBoxLayout:
        id: box_bottom
        adaptive_height: True
        padding: "10dp", 0, 0, 0

        MDLabel:
            text: root._staff.gender
            adaptive_height: True
            pos_hint: {"center_y": .5}
            theme_text_color: "Primary"

        MagicButton:
        MagicButton:
        MagicButton:
        MagicButton:
        MagicButton:

<MagicButton@MagicBehavior+MDIconButton>
    icon: "star"
    on_release: self.icon = "star-outline" if self.icon == "star" else "star"

<TitleLabel@Label>
    font_size: '18sp'
    font_style:'Button'
    halign:'left'
    text_size: (self.width, None)
    padding_x:40
    size_hint_x:1
    markup: True
    color: app.theme_cls.secondary_text_color
<MyIcon@MDIconButton>
    color: [.7,0,0,1]
    size_hint: None, None
    user_font_size: '20sp'
    theme_text_color: 'Custom'
    size: ('20dp', '20dp')
    text_color: [1,1,1,1]

<RotatingImage@FitImage>
    angle: 0
    canvas.before:
        PushMatrix
        Rotate:
            angle: root.angle
            origin: self.center
    canvas.after:
        PopMatrix

<MyTable>
    states_cities_or_areas: states_cities_or_areas

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            canvas.before:
                Rectangle:
                    pos: self.pos
                    size: self.size

            size_hint_y: 1

            MenuButton:
                id: btn
                text: 'Bills'
                size : (60,30)
                on_release: root.display_states()


        BoxLayout:
            canvas.before:
                Rectangle:
                    pos: self.pos
                    size: self.size

                Color:
                    rgb: (1,1,1)

            Label:
                size_hint_x: 45

        BoxLayout:
            id: states_cities_or_areas
            size_hint_y: 10

        Label:
            size_hint_y: 1

<PopupLabelCell>
    size_hint: (None, None)
    height: 30
    text_size: self.size
    halign: "left"
    valign: "middle"

<EditStatePopup>
    container: container
    size_hint: None, None
    size: 432, 279
    title_size: 20
    # title_font: "Verdana"
    auto_dismiss: False
    title_align: 'center'
    title_color: app.theme_cls.text_color
    separator_height: dp(0)
    background_color: app.theme_cls.accent_color
    BoxLayout:
        orientation: "vertical"
        #canvas.before:
        #    Color:
        #        rgba: app.theme_cls.divider_color
        #    Rectangle:
        #        size: self.size
        #        pos: self.pos
        ScrollView:
            bar_width: 10
            bar_color: 1, 0, 0, 1   # red
            bar_inactive_color: 0, 0, 1, 1   # blue
            effect_cls: "ScrollEffect"
            scroll_type: ['bars']
            size_hint: (1, 1)

            GridLayout:
                id: container
                cols: 2
                row_default_height: 30
                cols_minimum: {0: 100, 1: 300}
                # spacing: 10, 10
                # padding: 20, 20
                size_hint: (None, None)
                height: self.minimum_height

        BoxLayout:
            size_hint_y: None
            height: dp(52)
            padding: dp(39), dp(6),dp(39),0
            spacing: dp(39)
            orientation: 'horizontal'
            Button:
                text: "Save Changes"
                pos_hint: {'center_y': .5}
                on_release:
                    root.dismiss()
            Button:
                text: "Cancel Changes"
                pos_hint: {'center_y': .5}
                on_release: root.dismiss()

<SelectableButton>
    canvas.before:
        Color:
            rgba: (0, 0.517, 0.705, 1) if self.selected else (0, 0.517, 0.705, 1)
        Rectangle:
            pos: self.pos
            size: self.size
    background_color: [1, 0, 0, 1]  if self.selected else [1, 1, 1, 1]  # dark red else dark grey
    on_press: app.root.get_screen("administrator").ids.mytable.table.rv.on_mouse_select(self)

<HeaderCell>
    size_hint: (None, None)
    height: 25
    text_size: self.size
    halign: "left"
    valign: "middle"
    background_disabled_normal: ''
    disabled_color: (1, 1, 1, 1)

    canvas.before:
        Color:
            rgba: 1, 0.502, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size

<TableHeader>
    header: header
    bar_width: 0
    do_scroll: False
    size_hint: (1, None)
    height: 25
    effect_cls: "ScrollEffect"

    GridLayout:
        id: header
        rows: 1
        cols_minimum: root.cols_minimum
        size_hint: (None, None)
        width: self.minimum_width
        height: self.minimum_height

<RV>
    row_controller: row_controller

    bar_width: 10
    bar_color: 1, 0, 0, 1   # red
    bar_inactive_color: 0, 0, 1, 1   # blue
    effect_cls: "ScrollEffect"
    scroll_type: ['bars']

    data: root.rv_data
    viewclass: 'SelectableButton'

    SelectableRecycleGridLayout:
        id: row_controller
        key_selection: 'selectable'
        cols: root.total_col_headings
        cols_minimum: root.cols_minimum
        default_size: None, dp(26)
        default_size_hint: 1, None
        size_hint: None, None
        height: self.minimum_height
        width: self.minimum_width
        multiselect: True
        touch_multiselect: True


<MenuButton@Button>
    text_size: self.size
    valign: "middle"
    padding_x: 5
    size : (80,30)
    size_hint : (None, None)
    background_color: 90 , 90, 90, 90
    background_normal: ''
    color: 0, 0.517, 0.705, 1
    border: (0, 10, 0, 0)